{
  "causal_inference_report": {
    "timestamp": "2025-07-29T21:27:50.355546",
    "model_info": {
      "model_path": "best_model.pth",
      "architecture": "densenet121",
      "causal_confounders": {
        "age": 1,
        "sex": {
          "M": 0,
          "F": 1
        },
        "view_position": {
          "PA": 0,
          "AP": 1,
          "L": 2
        }
      }
    },
    "results": {
      "image_path": "xray.jpg",
      "prediction": {
        "class": "Normal",
        "confidence": 0.993608832359314,
        "probabilities": {
          "normal": 0.993608832359314,
          "pneumonia": 0.006391230970621109
        }
      },
      "confounders": {},
      "attributions": {
        "intervention": "tensor([[[1.1921e-07, 1.1921e-07, 1.1921e-07,  ..., 0.0000e+00,\n          0.0000e+00, 0.0000e+00],\n         [1.1921e-07, 1.1921e-07, 1.1921e-07,  ..., 0.0000e+00,\n          0.0000e+00, 0.0000e+00],\n         [1.1921e-07, 1.1921e-07, 1.1921e-07,  ..., 0.0000e+00,\n          0.0000e+00, 0.0000e+00],\n         ...,\n         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,\n          0.0000e+00, 0.0000e+00],\n         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,\n          0.0000e+00, 0.0000e+00],\n         [0.0000e+00, 0.0000e+00, 0.0000e+00,  ..., 0.0000e+00,\n          0.0000e+00, 0.0000e+00]]])",
        "counterfactual": "tensor([[[-8.3447e-07, -8.3447e-07, -8.3447e-07,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         [-8.3447e-07, -8.3447e-07, -8.3447e-07,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         [-8.3447e-07, -8.3447e-07, -8.3447e-07,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         ...,\n         [ 1.1921e-07,  1.1921e-07,  1.1921e-07,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         [ 1.1921e-07,  1.1921e-07,  1.1921e-07,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00],\n         [ 1.1921e-07,  1.1921e-07,  1.1921e-07,  ...,  0.0000e+00,\n           0.0000e+00,  0.0000e+00]]])",
        "aggregated": "tensor([[[0.5087, 0.5087, 0.5087,  ..., 0.7130, 0.7130, 0.7130],\n         [0.5087, 0.5087, 0.5087,  ..., 0.7130, 0.7130, 0.7130],\n         [0.5087, 0.5087, 0.5087,  ..., 0.7130, 0.7130, 0.7130],\n         ...,\n         [0.7565, 0.7565, 0.7565,  ..., 0.7130, 0.7130, 0.7130],\n         [0.7565, 0.7565, 0.7565,  ..., 0.7130, 0.7130, 0.7130],\n         [0.7565, 0.7565, 0.7565,  ..., 0.7130, 0.7130, 0.7130]]])"
      },
      "intervention_analysis": {
        "avg_effect": 7.450580596923828e-07,
        "max_effect": 9.5367431640625e-07,
        "robustness": 0.9999992501495202,
        "effects": [
          9.5367431640625e-07,
          5.960464477539062e-07,
          5.960464477539062e-07,
          8.344650268554688e-07
        ]
      },
      "counterfactual_analysis": {
        "cf_confidence": 0.006391230970621109,
        "causal_strength": 0.9872176013886929,
        "spurious_level": 0.012782398611307144
      },
      "causal_confidence": 0.9936085343360901,
      "clinical_interpretation": {
        "prediction_reliability": "Very High - Strong evidence for diagnosis",
        "model_robustness": "Very Robust - Model is insensitive to perturbations",
        "causal_evidence": "Strong - Clear causal relationship",
        "clinical_recommendation": "High confidence - Consider this diagnosis"
      },
      "original_image": "[[10. 11. 11. ... 34. 34. 37.]\n [18. 19. 20. ... 57. 58. 56.]\n [ 1.  2.  2. ... 32. 33. 29.]\n ...\n [36. 36. 37. ... 93. 88. 91.]\n [37. 38. 38. ... 92. 88. 92.]\n [34. 37. 38. ... 94. 92. 92.]]"
    }
  }
}